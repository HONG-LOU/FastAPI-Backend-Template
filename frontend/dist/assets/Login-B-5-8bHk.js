import{d as _,u as y,p as b,r as N,o as h,s as k,q,v as x,c as B,g as s,w as o,h as a,l as C,k as F,e as I,m,a as M}from"./index-D1dR0X0d.js";import{N as S,a as T,b as c}from"./FormItem-B257f-0z.js";import{u as U,N as f,B as g,_ as V}from"./_plugin-vue_export-helper-BD59ZGkT.js";const A={class:"wrap"},L={class:"actions"},R=_({__name:"Login",setup($){const n=x(),i=q(),d=U(),p=y(),t=b({email:"",password:""}),v={email:{required:!0,message:"请输入邮箱",trigger:["input","blur"]},password:{required:!0,message:"请输入密码",trigger:["input","blur"]}},l=N(!1);h(()=>{if(k(),p.isAuthenticated){const r=i.query.redirect||"/";n.replace(r)}});async function w(){l.value=!0;try{const{data:r}=await M.post("/api/auth/login",{email:t.email,password:t.password});p.setTokens(r),d.success("登录成功");const e=i.query.redirect||"/";n.replace(e)}catch(r){d.error(r?.response?.data?.message||"登录失败")}finally{l.value=!1}}return(r,e)=>(C(),B("div",A,[s(a(S),{class:"card",title:"登录"},{default:o(()=>[s(a(T),{model:t,rules:v,onSubmit:F(w,["prevent"])},{default:o(()=>[s(a(c),{label:"邮箱",path:"email"},{default:o(()=>[s(a(f),{value:t.email,"onUpdate:value":e[0]||(e[0]=u=>t.email=u),placeholder:"you@example.com"},null,8,["value"])]),_:1}),s(a(c),{label:"密码",path:"password"},{default:o(()=>[s(a(f),{value:t.password,"onUpdate:value":e[1]||(e[1]=u=>t.password=u),type:"password","show-password-on":"mousedown"},null,8,["value"])]),_:1}),I("div",L,[s(a(g),{type:"primary","attr-type":"submit",loading:l.value},{default:o(()=>[...e[3]||(e[3]=[m("登录",-1)])]),_:1},8,["loading"]),s(a(g),{quaternary:"",onClick:e[2]||(e[2]=u=>r.$router.push({name:"register"}))},{default:o(()=>[...e[4]||(e[4]=[m("去注册",-1)])]),_:1})])]),_:1},8,["model"])]),_:1})]))}}),z=V(R,[["__scopeId","data-v-3b826618"]]);export{z as default};
